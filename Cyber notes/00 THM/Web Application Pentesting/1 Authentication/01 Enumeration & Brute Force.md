https://tryhackme.com/room/enumerationbruteforce

### Table of contents
- [[#Authentication Enumeration]]
- [[#Verbose Errors]]
- [[#Vulnerable Password Reset]]
- [[#HTTP Basic Authentication]]
- [[#OSINT]]

___
### Authentication Enumeration
[[#Table of contents|Back to the top]]

**Identifying Valid Usernames**
Enables to focus on password guessing. Doable by brute-forcing and analyzing error messages.

**Password Policies**
Guidelines provide insights about possible password complexity (--> regex)

#### Common Places to Enumerate

**Registration Pages**
--> Valid usernames/emails

**Password Reset**
--> Valid usernames/emails

**Verbose Errors**
--> "username not found" / "incorrect password"

**Data Breach**
--> Compromised usernames, passwords

___
### Verbose Errors
[[#Table of contents|Back to the top]]

Can reveal info about
- **Internal Paths:** file paths, directory structures
- **Database Details:** table names, column details
- **User Info:** usernames or other personal data

Attacker induces verbose errors
- **Invalid Login Attempts:** intentionally enter invalid usernames-passwords to find valid ones
- **SQL Injection:** reveal info about database structure
- **File Inclusion / Path Traversal:** using `../../` could lead to errors disclosing restricted file paths for instance
- **Form Manipulation:** tweaking form fields / parameters can lead to errors disclosing backend logic, for instance altering hidden form fields
- **Application Fuzzing:** sending unexpected input to various parts of app --> Burps Suite Intruder, bombard app with varied payloads

**Invalid login attempts automation:** [[enum_email_auth.py]] with [usernames_gmail.com.txt](https://github.com/nyxgeek/username-lists/blob/master/usernames-top100/usernames_gmail.com.txt) for instance

___
### Vulnerable Password Reset
[[#Table of contents|Back to the top]]

**Email-Based**
Reset link / token --> relies on email account security

**Security Question-Based**
Can be easily compromised through OSINT and other methods

**SMS-Based**
Relies on phone security, vulnerable to SIM swapping attacks or intercepts

#### Vulnerabilities
- **Predictable Tokens**: guess / brute-force to generate valid reset URLs / tokens
- **Token Expiration Issues**: provide window of opportunity for attackers
- **Insufficient Validation**: too common questions / compromised email account
- **Information Disclosure**: error message specifying whether email address / username is registered
- **Insecure Transport**: transmission of reset links / tokens over non-HTTPS connections --> vulnerable to interception

##### Predictable Tokens
`http://enum.thm/labs/predictable_tokens/reset_password.php?token=123`
--> Burps Suite Intruder --> Sniper --> Brute-force token

___
### HTTP Basic Authentication
[[#Table of contents|Back to the top]]

Basic authentication: username-password

HTTP Basic authentication: credentials should be base64-encoded in transit within HTTP Authorization header

![[Pasted image 20260123184050.png]]
*--> Authorization: Basic <base64(username:password)>*

--> Use Burp Suite Intruder to brute-force using prefix admin:, and base64 encoding
*Can also be done using [[01 Hydra|Hydra]]* 

___
### OSINT
[[#Table of contents|Back to the top]]

**[Internet Archive's Wayback Machine](https://archive.org/web/)**

**[Wayback URLs](https://github.com/tomnomnom/waybackurls):** dump all links saved on Wayback Machine

**Google Dork**
*Examples*
- Admin panels: `site:example.com inurl:admin`
- Log files with passwords: `filetype:log "password" site:example.com`
- Backup directories: `intitle:"index of" "backup" site:example.com`