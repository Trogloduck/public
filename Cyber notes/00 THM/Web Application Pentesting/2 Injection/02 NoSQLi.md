https://tryhackme.com/room/nosqlinjectiontutorial

### Table of contents
- [[#Intro]]

___
### Intro
[[#Table of contents|Back to the top]]

MongoDB: database, can store data in ordered way

Information stored in "**documents**" (dictionary -- key-value pairs)
*e.g. :* `{"_id" : ObjectId("5f077332de2cdf808d26cd74"), "username" : "lphillips", "first_name" : "Logan", "last_name" : "Phillips", "age" : "65", "email" : "lphillips@example.com" }`

Group of documents = **collection**, equivalent of table in relational databases

Group of collections = **database**

##### Queries

Structured associative array containing groups of criteria to filter info, similar to SQL `WHERE`

*e.g. :*
![[Pasted image 20260220150535.png]]

`['last_name' => 'Sandler']`
*retrieves 2nd document*

`['gender' => 'male', 'last_name' => 'Phillips']`
*retrieves 1st document* 

`['age' => ['$lt' => '50']]`
*retrieves 2nd and 3rd documents*

[MongoDB Operators](https://www.mongodb.com/docs/manual/reference/mql/query-predicates/)

___
### NoSQLi
[[#Table of contents|Back to the top]]

Root cause of injection: improper concatenation of user input into a command, allowing attacker to alter the command

**SQLi:** adding quote

**NoSQLi:** can't escape current query with quote like in SQLi, but can still alter command
- **Syntax Injection:** similar to SQLi (break out of query, inject own payload)
- **Operator Injection:** can't break out, can still inject NoSQL operator to manipulate query's behavior
*Syntax injection way less common than Operator injection --> focus on operator injection*

##### Injection
Must be able to inject arrays into application

*e.g. : if succeed to inject* 
`$user = ['$ne'=>'xxxx']` *and* `$pass = ['$ne'=>'yyyy']`
*=> could return all documents where username isn't "xxxx" and password isn't "yyyy"*

**Payload:** `user[$ne]=xxxx&pass[$ne]=yyyy` in POST Request Body

___
### 
[[#Table of contents|Back to the top]]



___
### 
[[#Table of contents|Back to the top]]



___
### 
[[#Table of contents|Back to the top]]



___
### 
[[#Table of contents|Back to the top]]



___
### 
[[#Table of contents|Back to the top]]



___
