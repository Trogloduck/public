https://tryhackme.com/room/nmap03

### Table of contents
- [[#TCP Null, FIN, Xmas Scans]]
- [[#TCP Maimon]]
- [[#TCP ACK, Window, Custom Scans]]
- [[#Spoofing and Decoys]]
- [[#Fragmented Packets]]
- 

___
### TCP Null, FIN, Xmas Scans
[[#Table of contents|Back to the top]]

**Null** Scan
`-sN`: no flag sent

**FIN** Scan
`-sF`: `FIN` flag

**Xmas** Scan
`-sX`: `FIN, PSH, URG` flags

For all those 3 scans
- Open: no response
- Closed: `RST, ACK` response

___
### TCP Maimon
[[#Table of contents|Back to the top]]

>**Won't work on most modern networks**

`-sM`: `FIN, ACK` flags
Open: `RST` response

*In certain BSD-derived systems packet would be dropped in case of open port*

___
### TCP ACK, Window, Custom Scans
[[#Table of contents|Back to the top]]

**TCP ACK** Scan
`-sA`: `ACK` flag
Open/Closed: `RST` response

Useful when scanning target with **firewall**: informs on which ports aren't blocked by firewall

**Window** Scan
`-sW`: `ACK` flag
Open/Closed: `RST` response

Similar to TCP ACK Scan but examines `Window` field in RST packet. Reveals open ports on specific systems with a firewall.

**Custom** Scan
`--scanflags <flags>` (example: `scanflags RSTSYNFIN`)

___
### Spoofing and Decoys
[[#Table of contents|Back to the top]]

`-S SPOOFED_IP`
1. Attacker sends packet with spoofed source IP to target
2. Target replies to spoofed IP as destination
3. Attacker captures replies

In general, specify network interface: **`-e`** and disable ping scan: **`-Pn`** 

When on same network as target, possibility to spoof **MAC** too: `--spoof-mac SPOOFED_MAC` 

**Decoys**: make scan appear as coming from many IP to drown attacker IP
`-D DECOY1,DECOY2,DECOY3, ME`
Use `RND` to assign random IP to decoy

___
### Fragmented Packets
[[#Table of contents|Back to the top]]

`-f`: fragment packet to escape detection by firewalls and IDS, into 8-bytes fragments
`-ff`: into 16-bytes fragments

![[Pasted image 20251217114832.png]]
Only the `data` is fragmented. IP uses Identification (ID) and fragment offset to reassemble data at reception

___
### Idle/Zombie Scan
[[#Table of contents|Back to the top]]



___
### 
[[#Table of contents|Back to the top]]



___
