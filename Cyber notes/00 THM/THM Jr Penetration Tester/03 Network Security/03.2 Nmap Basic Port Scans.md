https://tryhackme.com/room/nmap02

### Table of contents
- [[#Intro]]
- [[#TCP Flags]]
- [[#TCP Connect Scan]]
- [[#TCP SYN Scan]]
- [[#UDP Scan]]
- [[#Fine-Tuning Scope and Performance]]

___
### Intro
[[#Table of contents|Back to the top]]

Only one service can run on a port

**Open:** service is running on port
**Closed:** no service is running

Nmap considers 6 states
1. **Open:** service is listening
2. **Closed:** no service listening, port is accessible
3. **Filtered:** cannot determine open/closed, port is inaccessible (usually due to firewall)
4. **Unfiltered:** cannot determine open/closed, port is accessible, encountered when using ACK scan (`-sA`)
5. **Open|Filtered:** cannot determine open/filtered
6. **Closed|Filtered:** cannot determine closed/filtered

___
### TCP Flags
[[#Table of contents|Back to the top]]

1. **URG**: incoming data is urgent, processed immediately without waiting for previously sent TCP segments
2. **ACK**: acknowledge receipt
3. **PSH** (PUSH): pass data to application promptly
4. **RST**: reset connection (firewall might send it to tear TCP connection)
5. **SYN**: initiate TCP 3-way handshake
6. **FIN**: no more data to send

___
### TCP Connect Scan
[[#Table of contents|Back to the top]]

`-sT`: tears down connection at end of 3-way handshake with RST, ACK packet
1. `SYN` -->
2. <-- `SYN, ACK`
3. `ACK` -->
   `RST, ACK` -->

___
### TCP SYN Scan
[[#Table of contents|Back to the top]]

*For unprivileged user*

`-sS`: tears down connection as soon as receives response
1. `SYN` -->
2. <-- `SYN, ACK`
3. `RST` -->

___
### UDP Scan
[[#Table of contents|Back to the top]]

`-sU`: sends UDP packet
Open: no response
Closed: `ICMP Type 3, Code 3` response

___
### Fine-Tuning Scope and Performance
[[#Table of contents|Back to the top]]

Specify **ports** instead of default 1000 ports
- List: `-p22,80,443`
- Range: `-p1-1023` (bounds included)
- `-p-`: all ports (65 535)
- `-F`: 100 most common ports
- `--top-ports 10`: ...

Scan **timing**: `-T<0-5>`
- `0`: "paranoid", 5 minutes interval
- `1` (realistic): "sneaky", 
- `2`: "polite"
- `3` (default): "normal"
- `4` (use in CTF): "aggressive"
- `5`: "insane"
*faster can also be less accurate (more packet loss)*

Packet **rate**: `--min-rate <number>` / `--max-rate <number>` (number of packets sent / second)

**Parallelization**: `--min-parallelism <numprobes>` / `--max-parallelism <numprobes>` 