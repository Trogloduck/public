https://tryhackme.com/room/owasptop102021

### Table of contents
- [[#1. Broken Access Control]]
- [[#2. Cryptographic Failures]]
- [[#3. Injection]]
- [[#4. Insecure Design]]
- [[#5. Security Misconfiguration]]
- [[#6. Vulnerable and Outdated Components]]
- [[#7. Identification and Authentication Failures]]
- [[#8. Software and Data Integrity Failures]]
- [[#9. Security Logging & Monitoring Failures]]
- [[#10. Server-Side Request Forgery (SSRF)]]

___
### 1. Broken Access Control
[[#Table of contents|Back to the top]]

Some web pages are protected: only admin should be able to access
--> View sensitive information, access special functionalities

**[[5 IDOR|IDOR]]** (Insecure Direct Object Reference) is a type of broken access control
"Object": file, user, bank account, ...

NB: if `id` in URL is modifiable, don't forget to check `id=0`

___
### 2. Cryptographic Failures
[[#Table of contents|Back to the top]]

Data not sufficiently encrypted

___
### 3. Injection
[[#Table of contents|Back to the top]]

User input not sanitized and validated (and allow list: compare input to list of safe inputs/characters)

Command Injection: server-side code (like PHP) makes a call to a function that interacts with server's console directly
--> attacker executes OS commands on server

```php
<?php
    if (isset($_GET["mooing"])) {
        $mooing = $_GET["mooing"];
        $cow = 'default';

        if(isset($_GET["cow"]))
            $cow = $_GET["cow"];
        
        passthru("perl /usr/bin/cowsay -f $cow $mooing");
    }
?>
```
In this example, we can modify the `passthru("perl /usr/bin/cowsay -f $cow $mooing");` line in order to execute commands on the server. We can change `$cow` with `$(whoami)`, `$(ifconfig/ip addr)`, ...

___
### 4. Insecure Design
[[#Table of contents|Back to the top]]

Vulnerability inherent to app architecture --> allows brute-force for instance

___
### 5. Security Misconfiguration
[[#Table of contents|Back to the top]]



___
### 6. Vulnerable and Outdated Components
[[#Table of contents|Back to the top]]



___
### 7. Identification and Authentication Failures
[[#Table of contents|Back to the top]]



___
### 8. Software and Data Integrity Failures
[[#Table of contents|Back to the top]]



___
### 9. Security Logging & Monitoring Failures
[[#Table of contents|Back to the top]]



___
### 10. Server-Side Request Forgery (SSRF)
[[#Table of contents|Back to the top]]

