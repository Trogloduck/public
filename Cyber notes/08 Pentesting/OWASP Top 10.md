https://tryhackme.com/room/owasptop10

### Table of contents
- [[#1. Injection]]
- [[#2. Broken Authentication]]
- [[#3. Sensitive Data Exposure]]
- [[#4. XXE - XML External Entity]]
- [[#5. Broken Access Control]]
- [[#6. Security Misconfiguration]]
- [[#7.Cross-site Scripting]]
- [[#8. Insecure Deserialization]]
- [[#9. Components with Known Vulnerabilities]]
- [[#10. Insufficent Logging & Monitoring]]

___
### 1. Injection
[[#Table of contents|Back to the top]]

Very common, user controlled input interpreted as actual commands/parameters
- SQL Injection --> access, modify, delete information in database
- Command Injection --> gain access to users systems

Defence
- Allow list: list of safe input/characters
- Stripping input: remove characters that make input interpreted as query/command
	--> look for libraries that can do that

##### OS Command Injection
Server-side code (like PHP) makes system call on hosting machine --> attackers exploits this vulnerability to execute OS commands on server
--> `whoami`, spawn reverse shell `;nc -e /bin/bash`
--> [Reverse Shell Cheatsheet](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md)

Active Command Injection: return responses to user, through HTML elements for instance (as opposed to blind command injection)

___
### 2. Broken Authentication
[[#Table of contents|Back to the top]]

Common flaws
- Brute force --> limit number of attempts
- Weak credentials --> strong password policies
- Weak Session Cookies: if session cookie contains predictable values, attacker can set their cookie to access other users session information

##### Re-registration of existing user
Re-register as " target_user" (space is important), memorize password
When you connect with " target_user" and password you can access the target user's session

___
### 3. Sensitive Data Exposure
[[#Table of contents|Back to the top]]

Web app accidentally divulges sensitive data --> Man in The Middle

Most common way to store large amount of data in a format that is easily accessible from many locations at once is in a database --> SQL, NoSQL, either
- running MySQL or MariaDB on **dedicated server**
- stored as files "**flat-file**", easier, common for smaller webapps, most common format *sqlite*, client *sqlite3*

1. `sqlite3 database.db`
2. `.tables`
3. `PRAGMA table_info(name_of_table);`: display table information
4. `SELECT * FROM name_of_table;`

In the example, the database was stored in `[ip_address]/assets`

___
### 4. XXE - XML External Entity
[[#Table of contents|Back to the top]]

Allows attacker to interact with backend or external systems that application can access
Can be used to DoS, [[7 SSRF|SSRF]] (Server-Side Request Forgery), port scan and execute remote code

- **In-band** XXE: attacker receives **immediate response** to XXE payload
- **OOB-XXE** (out-of-band or "blind"): **no immediate response**, attacker has to reflect output to some other file or server

[[XML]]

##### XXE payloads
```XML
<!DOCTYPE replace [<!ENTITY name "feast"> ]>  
 <userInfo>  
  <firstName>falcon</firstName>  
  <lastName>&name;</lastName>  
 </userInfo>
```
*defining a `ENTITY` called `name` and assigning it a value `feast`*

```XML
<?xml version="1.0"?>
<!DOCTYPE root [<!ENTITY read SYSTEM 'file:///etc/passwd'>]>
<root>&read;</root>
```
*defining an `ENTITY` called `read` and assigning it a value `SYSTEM´and path of target file*

Modify the payload with default names for sensitive information such as `/home/[username]/.ssh/id_rsa`

___
### 5. Broken Access Control
[[#Table of contents|Back to the top]]

Some pages should only be accessible to admins (for instance, a page allowing to manage other users), if not then attacker can access sensitive data or perform tasks they shouldn't be able to

[[5 IDOR|IDOR]] - Insecure Direct Object Reference is a type of access control vulnerability

___
### 6. Security Misconfiguration
[[#Table of contents|Back to the top]]

- Poorly configured permissions on cloud services, like S3 buckets
- Unnecessary features enabled, like services, pages, accounts or privileges
- Default accounts with unchanged passwords
- Overly detailed error messages that allow attacker to find out more about system
- Not using [HTTP security headers](https://owasp.org/www-project-secure-headers/), or revealing too much detail in the Server: HTTP header

More info: https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html

___
### 7.Cross-site Scripting
[[#Table of contents|Back to the top]]



___
### 8. Insecure Deserialization
[[#Table of contents|Back to the top]]



___
### 9. Components with Known Vulnerabilities
[[#Table of contents|Back to the top]]



___
### 10. Insufficent Logging & Monitoring
[[#Table of contents|Back to the top]]


