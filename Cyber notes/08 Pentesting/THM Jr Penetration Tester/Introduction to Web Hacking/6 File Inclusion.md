### Table of contents
- [[#Intro]]
- 

___
### Intro
[[#Table of contents|Back to the top]]

![[Pasted image 20250418150136.png]]

Main issue: input validation -- sanitization, validation

File inclusion can be used to exfiltrate sensitive data or to gain RCE (Remote Command Execution) (if user can access and also write files)

___
### Path Traversal
[[#Table of contents|Back to the top]]

AKA Directory Traversal AKA dot-dot-slash: attacker can read OS resources (local files on server running app), done by manipulating URL

Path traversal vulnerability: user's input directly passed to function such as file_get_contents in PHP. Input should be validated and filtered 1st

Common paths to test traversal
- `/etc/issue`: message/ system identification before login prompt
- `/etc/profile`: system-wide 
- `/proc/version`: Linux kernel version
- `/etc/passwd`: all registered users that have access to system
- `/etc/shadow`: info about system's users passwords
- `/root/.bash_history`: root's history commands
- `/var/log/dmessage`: global system messages
- `/var/mail/root`: root's emails
- `/root/.ssh/id_rsa`: SSH keys for root or other user
- `/var/log/apache2/access.log`: accessed requests for Apache web server
- `C:\boot.ini`: boot options for computers with BIOS firmware

___
### LFI #1
[[#Table of contents|Back to the top]]

*Local File Inclusion*

PHP `include`, `require`, `include_once`, `require_once` often contribute to vulnerable web applications

LFI also occurs in ASP, JSP, Node.js

1. Web app provides 2 languages, lets user choose (EN/AR)
```php
<?PHP 
	include($_GET["lang"]);
?>
```
$\rightarrow$ `/index.php?lang=EN.php` display English
$\rightarrow$ `/index.php?lang=AR.php` display Arabic

If no input validation $\rightarrow$ possible to access any file on server
$\rightarrow$ `/get.php?file=/etc/passwd`

2. Developer specified directory
```php
<?PHP 
	include("languages/". $_GET['lang']); 
?>
```
