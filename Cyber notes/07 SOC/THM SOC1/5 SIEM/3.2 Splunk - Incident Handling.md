### Table of contents
- [[#Incident Handling Life Cycle]]
- [[#Context]]
- [[#Reconnaissance]]
- 

___
### Incident Handling Life Cycle
[[#Table of contents|Back to the top]]

1. **Preparation**
Requirements, policies, security controls to monitor (EDR/SIEM/IDS/IPS, etc.); hiring/training staff

2. **Detection & Analysis**
Alerts from security controls, investigating, threat hunting

3. **Containment, Eradication, Recovery**
Prevent incident from spreading: prevent spreading in network, isolate infected host, clear network from infection traces, regain control

4. **Post-Incident Activity -- Lessons Learned**
Identify vulnerabilities, improve (adding detection rules, training staff)

___
### Context
[[#Table of contents|Back to the top]]

https://tryhackme.com/room/splunk201

*imreallynotbatman.com has been defaced*

Investigate cyber attack into all 7 phases of [[2 Cyber Kill Chain|Cyber Kill Chain]]
NB: findings in one chain may map into another phase, not necessarily respecting the chain's order

- Reconnaissance
- Weaponization
- Delivery
- Exploitation
- Installation
- Command & Control
- Actions on Objectives

Logs ingested from `webserver/firewall/Suricata/Sysmon/etc`

| Log Source              | Description                                   |
| ----------------------- | --------------------------------------------- |
| **wineventlog**         | Windows Event logs                            |
| **winRegistry**         | Registry creation/modification/deletion etc.  |
| **XmlWinEventLog**      | sysmon event logs                             |
| **fortigate_utm  <br>** | Fortinet Firewall                             |
| **iis  <br>**           | IIS web server                                |
| **Nessus:scan  <br>**   | Nessus vulnerability scanner                  |
| **Suricata  <br>**      | Suricata IDS: triggered alerts, trigger cause |
| **stream:http  <br>**   | HTTP traffic                                  |
| **stream: DNS  <br>**   | DNS traffic                                   |
| **stream:icmp  <br>**   | ICMP traffic                                  |

___
### Reconnaissance
[[#Table of contents|Back to the top]]

Recon attempt against imreallynotbatman.com

**Search Query**: `index=botsv1 imreallynotbatman.com`

We want to identify an IP

$\rightarrow$ filter HTTP traffic: `sourcetype=stream:http`
	$\rightarrow$ examine src_ip
		40.80.148.42: 93.402% of traffic
		23.22.63.114

$\rightarrow$ click on 40.80.148.42 to append search query
	$\rightarrow$  look at interesting fields such as User-Agent, Post request, URIs, etc.

Validate scanning $\rightarrow$ Suricata: `sourcetype=suricata`
\> more fields > 'alert' > tick "alert.signature"

